# 14 задание в Яндекс.Практикуме
#### (Авторизация на сервере express c mongodb)


### Основные моменты:
- авторизация пользователя на сайте, запоминание пользователя браузером;
- безопасность. Хеширование пароля, сокрытие ключей авторизации в переменных окружения;

### Чеклист задания:

#### `./models/user`
- в схеме пользователя есть поля `email` и `password`;
- в схеме есть метод `findUserByCredentials`;
- поле `email` уникально и валидируется;

#### `./controllers/users`
- в контроллере `createUser` почта и хеш пароля записываются в базу;
- есть контроллер `login`, он проверяет полученные в теле запроса почту и пароль;
- если почта и пароль верные, контроллер `login` создаёт JWT, в пейлоуд которого записано свойство `_id` с -идентификатором пользователя; срок жизни токена — 7 дней;
- если почта и пароль верные, контроллер `login` возвращает созданный токен в ответе;
- если почта и пароль не верные, контроллер `login` возвращает ошибку 401;

#### `./middlewares/auth`
- есть файл `middlewares/auth.js`, в нём мидлвэр для проверки JWT;
- при правильном JWT авторизационный мидлвэр добавляет в объект запроса пейлоуд и пропускает запрос дальше;
- при неправильном JWT авторизационный мидвэр возвращает ошибку 401;

#### `./app и другие`
- в `app.js` есть обработчики POST-запросов на роуты /signin и /signup;
- все роуты, кроме `/signin` и `/signup`, защищены авторизацией;
- пользователь не может удалить карточку, которую он не создавал;
- API не возвращает хеш пароля;
- пользователь не может редактировать чужой профиль и не может менять чужой аватар.

### Дополнительно:
- создан документ `.env` . В нем хранится ключ авторизации;
- `orFail` не работает. Поэтому папка `errors` пока хранится на будущее.



